<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Dialogue Manager Programming Language (DMPL)</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script
            src='https://www.w3.org/Tools/respec/respec-w3c-common'
            class='remove'></script>
    <script class='remove'>
        let respecConfig = {
            wg: "Conversational Interfaces Working Group",
            wgURI: "https://www.w3.org/community/conv/",
            wgPublicList: "public-conv",
            specStatus: "CG-DRAFT",
            shortName: "dmpl",
            editors: [{
                name: "Nishant Shukla"
            }],
            authors: [{
                name: "Nelson Solano"
            }, {
                name: "Victor Zhang"
            }],
            edDraftURI: "https://github.com/w3c/dmpl",
            addSectionLinks: true,
            isPreview: true,
            lint: {
                "check-punctuation": true
            }
        };
    </script>
</head>
<body>

<section id='abstract'>
    <p>
        This specification defines the final draft of DMPL, which defines the behavior of interactive systems in a formal language.
        The user specifies the states (i.e. fluents), how they change (i.e. actions), and which are preferred (i.e. utility).
        These three components characterize a task, so we call DMPL a task-oriented programming language.
        The interpreter of the language should resolve the task by identifying and executing actions that maximize utility.
    </p>
</section>

<section id='sotd'></section>

<section id="conformance"></section>

<section>
    <h2>Introduction</h2>

    We decouple the representation of a task from its execution.
    Conversational interfaces employ artificial intelligence at varying levels: finite state machines, simulation engines, or reinforcement learning systems.
    This document concretely lays down the representation syntax, without going into the execution details.
    That way, a content writer may author and share conversational experiences without being distracted by the underlying runtime.
    <section>
        <h2>Scope</h2>
        <i>This section is informative.</i>
        <p>
            This document is limited to specifying the syntax for a general purpose <b>task-oriented</b> language for
            interactive agents. This document is targeted at applications that would be expected to be used by content
            authors on a frequent basis. One example application of DMPL is an authoring tool to be used on a regular
            basis by a non-technical content writer.
        </p>
    </section>
    <section>
        <h2>Goals and Motivation</h2>
        <i>This section is informative.</i>
        <p>
            DMPL is a task-oriented programming language, which may be better explained by extending <a href="https://bit.ly/2Huf6fG">Microsoft's Function
            Programming vs. Imperative Programming</a> table, shown below.
        </p>
        <table id="comparison-table">
            <tr>
                <th></th>
                <th>Imperative</th>
                <th>Functional</th>
                <th>Task-Oriented</th>
            </tr>
            <tr>
                <th>Programmer Focus</th>
                <td>How to perform tasks (algorithms) and how to track changes in state</td>
                <td>What information is desired and what transformations are required</td>
                <td>Why an action is taken and how information changes</td>
            </tr>
            <tr>
                <th>State Changes</th>
                <td>Important</td>
                <td>Non-existant (for purely functional languages)</td>
                <td>Important</td>
            </tr>
            <tr>
                <th>Order of Execution</th>
                <td>Programmer is mostly responsible</td>
                <td>Hybrid resposibility</td>
                <td>Compiler is mostly responsible</td>
            </tr>
            <tr>
                <th>Loops</th>
                <td>For/While, Recursion</td>
                <td>Recursion</td>
                <td>None, loops are implicit</td>
            </tr>
            <tr>
                <th>Primary Manipulation Unit</th>
                <td>Instances of structures or classes</td>
                <td>Functions</td>
                <td>Utility</td>
            </tr>
        </table>
    </section>
</section>


<section>
    <h2>Language Syntax</h2>
    <i>This section is normative.</i>
    <p>
        This section of the document defines the types used within this specification using <a href="">
        EBNF</a> notation with corresponding <a href="https://bit.ly/2Tk2EVX">railroad diagrams</a>.
    </p>

    <section>
        <h2><dfn>Atomic Types</dfn></h2>
        <section>
            <h2><code><dfn>literal</dfn></code></h2>
            <p>
                A <a>literal</a> is a terminal atom that may be assigned to a <a>variable</a>,
                used in a <a>dictionary</a>, or used as an operand to build an <a>expression</a>.
            </p>
            <blockquote>
	            <pre>
	                <a>literal</a> ::= <a>string</a> | <a>number</a> | <a>boolean</a> | 'null'
                </pre>
            </blockquote>
            <figure id="literal-railroad">
                <img src="diagrams/literal.png" alt="Literal rail-road diagram">
                <figcaption>Literal</figcaption>
            </figure>

        </section>

        <section>
            <h2><code><dfn>boolean</dfn></code></h2>
            <p>
                A <a>boolean</a> may take on values <code>true</code> or <code>false</code>.
            </p>
            <blockquote>
	            <pre>
	                <a>boolean</a> ::= 'true' | 'false'
                </pre>
            </blockquote>
            <figure id="boolean-railroad">
                <img src="diagrams/boolean.png" alt="Boolean rail-road diagram">
                <figcaption>Boolean</figcaption>
            </figure>
        </section>

        <section>
            <h2><code><dfn>name</dfn></code></h2>
            <p>
                A <a>name</a> is a sequence of characters conforming to those in the XML standard.
            </p>
            <blockquote>
	            <pre>
	                <a>name</a> ::= [ <a href="http://www.w3.org/TR/xml-names/#NT-NCName">http://www.w3.org/TR/xml-names/#NT-NCName</a> ]
                </pre>
            </blockquote>
            <figure id="name-railroad">
                <img src="diagrams/name.png" alt="Name rail-road diagram">
                <figcaption>Name</figcaption>
            </figure>
        </section>

        <section>
            <h2><code><dfn>quote_start</dfn></code></h2>
            <p>
                A <a>quote_start</a> is the starting quotation mark, which indicates the beginning of a string.
            </p>
            <blockquote>
	            <pre>
	                <a>quote_start</a> ::= '"' '`'
                </pre>
            </blockquote>
            <figure id="quote-start-railroad">
                <img src="diagrams/quote_start.png" alt="Quote-start rail-road diagram">
                <figcaption>Quote-start</figcaption>
            </figure>
        </section>

        <section>
            <h2><code><dfn>quote_close</dfn></code></h2>
            <p>
                A <a>quote_close</a> is the ending quotation mark, which indicates the termination of a string.
            </p>
            <blockquote>
	            <pre>
	                <a>quote_close</a> ::= '`' '"'
                </pre>
            </blockquote>
            <figure id="quote-close-railroad">
                <img src="diagrams/quote_start.png" alt="Quote-close rail-road diagram">
                <figcaption>Quote-close</figcaption>
            </figure>
        </section>

        <section>
            <h2><code><dfn>string</dfn></code></h2>
            <p>
                A <a>string</a> literal represents a finite sequence of characters.
                It is surrounded by starting and ending quotation marks.
            </p>
            <blockquote>
	            <pre>
	                <a>string</a> ::= <a>quote_start</a> <a>name</a> <a>quote_close</a>
                </pre>
            </blockquote>
            <figure id="string-railroad">
                <img src="diagrams/string.png" alt="String railroad diagram">
                <figcaption>String</figcaption>
            </figure>
            <pre class="example" title="string literal">
                "`hello`"
            </pre>
        </section>

        <section>
            <h2><code><dfn>digit</dfn></code></h2>
            <p>
                A <a>digit</a> represents a real valued integer in the range [0-9].
            </p>
            <blockquote>
	            <pre>
	                <a>digit</a> ::= [0-9]
                </pre>
            </blockquote>
            <figure id="digit-railroad">
                <img src="diagrams/digit.png" alt="Digit railroad diagram">
                <figcaption>Digit</figcaption>
            </figure>
        </section>

        <section>
            <h2><code><dfn>number</dfn></code></h2>
            <p>
                A <a>number</a> literal may represent either a positive or negative decimal value.
            </p>
            <blockquote>
	            <pre>
	                <a>number</a> ::= '-'? ( <a>digit</a>+ ( '.' <a>digit</a>* )? | '.' <a>digit</a>+ )
                </pre>
            </blockquote>
            <figure id="number-railroad">
                <img src="diagrams/number.png" alt="Number railroad diagram">
                <figcaption>Number</figcaption>
            </figure>
            <pre class="example" title="number literal">
                0.2
            </pre>
        </section>
    </section>

    <section>
        <h2><dfn>Container Structures</dfn></h2>
        <section>
            <h2><code><dfn>variable</dfn></code></h2>
            <p>
                Persistent memory is a mapping of names to values.
                The values are <a>expressions</a>, which may be accessed or modified in code.
                A <a>variable</a> is a named reference to a value.
            </p>
            <blockquote>
                    <pre>
                        <a>variable</a> :: = '"' <a>name</a> '"'
                    </pre>
            </blockquote>
            <figure id="variable-railroad">
                <img src="diagrams/variable.png" alt="Variable railroad diagram">
                <figcaption>Variable</figcaption>
            </figure>
            <pre class="example" title="variable">
                "num_correct_answers"
            </pre>
        </section>

        <section>
            <h2><code><dfn>dictionary</dfn></code></h2>
            <p>
                A <a>dictionary</a> is a structure that maps data in key-value pairs.
                The keys and values are all evaluated.
            </p>
            <blockquote>
                <pre>
                    <a>dictionary</a> : : = '{' ( <a>string</a> | <a>variable</a> ) ':' <a>expression</a>
                                     ( ',' ( <a>string</a> | <a>variable</a> ) ':' <a>expression</a> )* '}'
                </pre>
            </blockquote>
            <figure id="dictionary-railroad">
                <img src="diagrams/dictionary.png" alt="Dictionary railroad diagram">
                <figcaption>Dictionary</figcaption>
            </figure>
            <pre class="example" title="dictionary">
                {"`age`": "x", "`score`": 10, "`name`": "`Joe`"}
            </pre>
        </section>

        <section>
            <h2><code><dfn>expression</dfn></code></h2>
            <p>
                An <a>expression</a> may be evaluated, and that result is stored in memory to be referenced later.
                An expression may be denoted by a JSON array, in which case it is also called a <dfn>function</dfn>.
                The first element of the array represents the operator of the <a>function</a>.
                All remaining elements of the array constitute the operands.
            </p>
            <blockquote>
	            <pre>
	                <a>expression</a> ::= <a>literal</a>
                              | <a>variable</a>
                              | <a>dictionary</a>
                              | '[' ( <a>literal</a> | <a>variable</a> ) ( ',' <a>expression</a> )* ']'
                </pre>
            </blockquote>
            <figure id="expression-railroad">
                <img src="diagrams/expression.png" alt="Expression railroad diagram">
                <figcaption>Expression</figcaption>
            </figure>


            <table id="expression-table">
                <tr>
                    <th>Return Type</th>
                    <th>Operator</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <th><a>string</a></th>
                    <td><pre>"++"</pre></td>
                    <td><pre class="example">["++", "`hello`", "` `", "`world`"] // => "`hello world`"</pre></td>
                </tr>
                <tr>
                    <th><a>number</a></th>
                    <td><pre>"+"</pre></td>
                    <td><pre class="example">["+", 1, 2, 3, 4] // => 10</pre></td>
                </tr>
                <tr>
                    <th><a>number</a></th>
                    <td><pre>"-"</pre></td>
                    <td><pre class="example">["-", 5, 3] // => 2</pre></td>
                </tr>
                <tr>
                    <th><a>number</a></th>
                    <td><pre>"*"</pre></td>
                    <td><pre class="example">["*", 2, 4] // => 8</pre></td>
                </tr>
                <tr>
                    <th><a>number</a></th>
                    <td><pre>"/"</pre></td>
                    <td><pre class="example">["/", 1, 2] // => 0.5</pre></td>
                </tr>
                <tr>
                    <th><a>number</a></th>
                    <td><pre>"%"</pre></td>
                    <td><pre class="example">["%", 168, 2] // => 0</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"=="</pre></td>
                    <td><pre class="example">["==", 1, 1, 1, 2] // => false</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"!="</pre></td>
                    <td><pre class="example">["!=", 1, 2] // => true</pre></td>

                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>">"</pre></td>
                    <td><pre class="example">[">", 2, 3] // => false</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>">="</pre></td>
                    <td><pre class="example">[">=", 2, 3] // => false</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"<"</pre></td>
                    <td><pre class="example">["<", 2, 3] // => true</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"<="</pre></td>
                    <td><pre class="example">["<=", 2, 3] // => true</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"&&"</pre></td>
                    <td><pre class="example">["&&", true, true, false] // => false</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"||"</pre></td>
                    <td><pre class="example">["||", true, true, false] // => true</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"in"</pre></td>
                    <td><pre class="example">["in", 3, [1, 2, 3]] // => true</pre></td>
                </tr>
                <tr>
                    <th><a>boolean</a></th>
                    <td><pre>"input"</pre></td>
                    <td>
                        <pre class="example">["input"] // => true if there's an input</pre>
                        <pre class="example">["input", "yes"] // => true if there's an input and it equals "`yes`"</pre>
                    </td>
                </tr>
            </table>
        </section>
    </section>

    <section>
        <h2><dfn>Statements</dfn></h2>
        <section>
            <h2><code><dfn>statement</dfn></code></h2>
            <p>
                A <a>statement</a> may be one of three possible types: <a>effect</a>, <a>do</a>, or <a>fork</a>.
                Optionally, statements may contain <a>condition</a>, <a>await</a>, or <a>once</a> flags.
            </p>
            <blockquote>
	            <pre>
	                <a>statement</a> ::= '{' ( <a>condition</a> ',' )?
                               ( <a>await</a> ',' )?
                               ( <a>once</a> ',' )?
                               ( <a>effect</a> | <a>do</a> | <a>fork</a> ) '}'
                </pre>
            </blockquote>
            <figure id="statement-railroad">
                <img src="diagrams/statement.png" alt="Statement railroad diagram">
                <figcaption>Statement</figcaption>
            </figure>
        </section>

        <section>
            <h2><code><dfn>condition</dfn></code></h2>
            <p>
                A <a>condition</a> is a boolean expression that runs the statement if the expression evaluates to true.
                A condition check takes priority over other parts of the statement.
            </p>
            <blockquote>
	            <pre>
	                <a>condition</a> : : = '"if"' ':'  <a>expression</a>
                </pre>
            </blockquote>
            <figure id="condition-railroad">
                <img src="diagrams/condition.png" alt="Condition railroad diagram">
                <figcaption>Condition</figcaption>
            </figure>
            <pre class="example" title="condition">
                "if": [">", "num_wrong_answers", 3]
            </pre>
        </section>

        <section>
            <h2><code><dfn>await</dfn></code></h2>
            <p>
                An <a>await</a> blocks execution until a boolean expression evaluates to true.
            </p>
            <blockquote>
	            <pre>
	                <a>await</a> ::= '"await"' ':' <a>expression</a>
                </pre>
            </blockquote>
            <figure id="await-railroad">
                <img src="diagrams/await.png" alt="Await railroad diagram">
                <figcaption>Await</figcaption>
            </figure>
            <pre class="example" title="await">
                "await": ["input"]
            </pre>
        </section>

        <section>
            <h2><code><dfn>once</dfn></code></h2>
            <p>
                A <a>once</a> flag specified whether the statement can only be run once.
                By default, the once flag is set to false.
            </p>
            <blockquote>
	            <pre>
	                <a>once</a> ::= '"once"' ':' <a>boolean</a>
                </pre>
            </blockquote>
            <figure id="once-railroad">
                <img src="diagrams/once.png" alt="Once railroad diagram">
                <figcaption>Once</figcaption>
            </figure>
            <pre class="example" title="once">
                "once": true
            </pre>
        </section>

        <section>
            <h2><code><dfn>effect</dfn></code></h2>
            <p>
                An <a>effect</a> is a terminal node, meaning it does not produce more statements. There are 6 types of effects.
            </p>
            <blockquote>
	            <pre>
	                <a>effect</a> ::= <a>act</a> | <a>set</a> | <a>def</a> | <a>run</a> | <a>use</a> | <a>pop</a>
                </pre>
            </blockquote>
            <figure id="effect-railroad">
                <img src="diagrams/effect.png" alt="Effect railroad diagram">
                <figcaption>Effect</figcaption>
            </figure>
        </section>

        <section>
            <h2><code><dfn>act</dfn></code></h2>
            <p>
                An <a>act</a> represents an action specified by evaluating the expression. The result is interpreted by a client.
            </p>
            <blockquote>
	            <pre>
	                <a>act</a> ::= '"@act"' ':' <a>expression</a>
                </pre>
            </blockquote>
            <figure id="act-railroad">
                <img src="diagrams/act.png" alt="Act railroad diagram">
                <figcaption>Act</figcaption>
            </figure>
            <pre class="example" title="act">
                "@act": {
                  "`object`": "`tutor`",
                  "`action`": "`say`",
                  "`params`": {"`intent`": "`greeting`"}
                }
            </pre>
        </section>

        <section>
            <h2><code><dfn>set</dfn></code></h2>
            <p>
                A <a>set</a> updates the value of the <a>variable</a>, where the name of the variable is specified by evaluating the expression.
            </p>
            <blockquote>
	            <pre>
	                <a>set</a> ::= '"@set"'  ':' <a>expression</a> ',' '"val"' ':' <a>expression</a>
                </pre>
            </blockquote>
            <figure id="set-railroad">
                <img src="diagrams/set.png" alt="Set railroad diagram">
                <figcaption>Set</figcaption>
            </figure>
            <pre class="example" title="set">
                "@set": "`is_user_greeted`", "val": true
            </pre>
        </section>

        <section>
            <h2><code><dfn>def</dfn></code></h2>
            <p>
                A <a>def</a> defines a new <a>expression</a> that can be used later in the code.
            </p>
            <blockquote>
	            <pre>
	                <a>def</a> ::= '"@def"' ':' <a>expression</a> ',' '"val"' ':' <a>statement</a>
                </pre>
            </blockquote>
            <figure id="def-railroad">
                <img src="diagrams/def.png" alt="Def railroad diagram">
                <figcaption>Def</figcaption>
            </figure>
            <pre class="example" title="def">
                "@def": ["", "`inc`", "`x`"], "val": {"@pop": ["+", 1, "x"]}
            </pre>
        </section>

        <section>
            <h2><code><dfn>run</dfn></code></h2>
            <p>
                A <a>run</a> calls DMPL code in another file, optionally passing in arguments. The current fluents are stored on the stack.
            </p>
            <blockquote>
	            <pre>
	                <a>run</a> ::= '"@run"' ':' <a>expression</a> ( ',' '"args"' ':' <a>expression</a> )?
                </pre>
            </blockquote>
            <figure id="run-railroad">
                <img src="diagrams/run.png" alt="Run railroad diagram">
                <figcaption>Run</figcaption>
            </figure>
            <pre class="example" title="run">
                "@run": "Outro"
            </pre>
            <pre class="example" title="run with args">
                "@run": "Question", "args": ["", "`What's the largest planet?`", "`Jupiter`"]
            </pre>
        </section>

        <section>
            <h2><code><dfn>use</dfn></code></h2>
            <p>
                A <a>use</a> calls DMPL code in another file, optionally passing in <a>variable</a> names. It's similar to <code>from os import path</code> notation in Python.
            </p>
            <blockquote>
	            <pre>
	                <a>use</a> ::= '"@use"' ':' <a>expression</a> ( ',' '"import"' ':' <a>expression</a> )?
                </pre>
            </blockquote>
            <figure id="use-railroad">
                <img src="diagrams/use.png" alt="Use railroad diagram">
                <figcaption>Use</figcaption>
            </figure>
            <pre class="example" title="use">
                "@use": "`MathExpressions`", "import": ["", "`inc`", "`square`", "`exp`"]
            </pre>
        </section>

        <section>
            <h2><code><dfn>pop</dfn></code></h2>
            <p>
                A <a>pop</a> quits execution on the current DMPL code, pops the fluent-state from the stack, and resumes execution from the previous <a>run</a> location.
            </p>
            <blockquote>
	            <pre>
	                <a>pop</a> ::= '"@pop"' ':' <a>expression</a>
                </pre>
            </blockquote>
            <figure id="pop-railroad">
                <img src="diagrams/pop.png" alt="Pop railroad diagram">
                <figcaption>Pop</figcaption>
            </figure>
            <pre class="example" title="pop">
                "@pop": true
            </pre>
        </section>

        <section>
            <h2><code><dfn>do</dfn></code></h2>
            <p>
                A <a>do</a> statement specifies a list of statements to be executed.
            </p>
            <blockquote>
	            <pre>
	                <a>do</a> ::= '"@do"' ':' '[' ( <a>statement</a> ( ',' <a>statement</a> )* )? ']'
                </pre>
            </blockquote>
            <figure id="do-railroad">
                <img src="diagrams/do.png" alt="Do railroad diagram">
                <figcaption>Do</figcaption>
            </figure>
            <pre class="example" title="do">
                "@do": [
                  {"@act": "a"},
                  {"@act": "b"},
                  {"@act": "c"}
                ]
            </pre>
        </section>

        <section>
            <h2><code><dfn>fork</dfn></code></h2>
            <p>
                A <a>fork</a> statement specifies the branch-like behavior of the list of statements that follow.
            </p>
            <blockquote>
	            <pre>
	                <a>fork</a> ::= '"@fork"' ':' '[' ( <a>statement</a> ( ',' <a>statement</a> )* )? ']' ( ',' <a>scheme</a> )?
                </pre>
            </blockquote>
            <figure id="fork-railroad">
                <img src="diagrams/fork.png" alt="Fork railroad diagram">
                <figcaption>Fork</figcaption>
            </figure>
            <pre class="example" title="fork">
                "@fork": [
                  {"if": "is_user_greeted", "@act": "a"},
                  {"if": [">", "num_wrong_answers", 3], "@act": "b"},
                  {"@act": "c"}
                ]
            </pre>
        </section>

        <section>
            <h2><code><dfn>scheme</dfn></code></h2>
            <p>
                A <a>scheme</a> is associated with a <a>fork</a> statement, and it describes the fork branch resolution strategy.
            </p>
            <blockquote>
	            <pre>
	                <a>scheme</a> ::= '"scheme"' ':' <a>expression</a>
                </pre>
            </blockquote>
            <figure id="scheme-railroad">
                <img src="diagrams/scheme.png" alt="Scheme railroad diagram">
                <figcaption>Scheme</figcaption>
            </figure>
            <pre class="example" title="scheme">
                {"depth": 3}
            </pre>
        </section>

    </section>
</section>
<section>
    <h2>Examples</h2>
    <i>This section is informative.</i>
    <p>
        This section details DMPL conforming example programs.
    </p>
    <pre class="example" title="Hello World!">
        {
          "@act": "`hello world`"
        }
    </pre>
    <pre class="example" title="Do-statement">
        {
          "@do": [
            {"@act": "`hello`"},
            {"@act": "`world`"}
          ]
        }
    </pre>
    <pre class="example" title="If-Else Control Flow">
        {
          "@fork": [
            {"if": ["==", ["+", 2, 2], 4], "@act": "`this statement is run`"},
            {"@act": "`never reached`"}
          ]
        }
    </pre>
    <pre class="example" title="Variables">
        {
          "@fork": [
            {"if": ["?", "`x`"], "@set": "`x`", "val": 0},
            {"@do": [
              {"@set": "`x`", "val": ["+", 1, "x"]},
              {"@act": "x"}
            ]}
          ]
        }
    </pre>
    <pre class="example" title="Define New Expression">
        {
          "@do": [
            {"@def": ["", "`inc`", "`x`"], "val": {"@pop": ["+", 1, "x"]}},
            {"@act", ["`inc`", 5]}
          ]
        }
    </pre>
    <pre class="example" title="Unpacking an Array">
        {
          "@do": [
            {"@set": "`content`", "val": ["", "`What's the biggest planet?`", "`Jupiter`"]},
            {"@set": ["", "`Prompt`", "`Correct-Answer`"], "val": "`content`"}
          ]
        }
    </pre>
    <pre class="example" title="Running Components">
        {"@do":
          {"@run": "`Question`", "args": ["", "`What's the biggest planet?`", "`Jupiter`"]},
          {"await": ["return"], "@fork": [
            {"if": ["return", true], "@set": "`score`", "val": 100},
            {"@set": "`score`", "val": 0}
          ]}
        }
    </pre>
    <pre class="example" title="Importing Expressions">
        {
          "@do": [
            {"@use": "`MathExpressions`", "import": ["", "`square`", "`exp`"]},
            {"@act": ["==", ["`square`", 6], ["`exp`", 6, 2]]}
          ]
        }
    </pre>
    <pre class="example" title="Input Handling">
        {
          "@do": [
            {"@act": "`are you ready?`"},
            {"await": ["input"], "@fork": [
              {"if": ["input", "`yes`"], "@act": "`great`"},
              {"if": ["input", "`no`"], "@act": "`no problem`"}
            ]}
          ]
        }
    </pre>
    <pre class="example" title="Greet and Ask Question">
        {
          "scheme": {"depth":  2}, "@fork": [
            {"if": ["?", "`greeted`"], "@set": "`greeted`", "val": false},
            {"if": ["==", "greeted", false], "@do": [
              {"@act": "`hello`"},
              {"@set": "`greeted`", "val": true}
            ]},
            {"if": ["==", "greeted", true], "@do": [
              {"@act": "`how are you?`"},
              {"@set": "`asked_feelings`", "val": true},
              {"await": ["input"], "@fork": [
                {"if": ["input", "`good`"], "@act": "`great`"}
              ]}
            ]}
          ]
        }
    </pre>
    <pre class="example" title="Planet Trivia">
        {
          "@fork": [
            {"@do": [
              {"@set": "`Init`", "val": true},
              {"@set": "`Wrong-Counter`", "val": 0},
              {"@set": "`Is-Hint1-Given`", "val": false},
              {"@set": "`Is-Hint2-Given`", "val": false},
              {"@set": "`Is-Answer-Given`", "val": false},
              {"@set": "`Num-Hints-Given`", "val": 0},
              {"@set": "`Question`", "val": "`What's the biggest planet?`"},
              {"@set": "`CA`", "val": "`planet.jupiter`"},
              {"@set": "`CA-Response`", "val": "`Exactly!`"},
              {"@set": "`WA1`", "val": "`planet`"},
              {"@set": "`WA1-Response`", "val": "`Nope. That's not the biggest`"},
              {"@set": "`WA2`", "val": "`nonplanet`"},
              {"@set": "`WA2-Response`", "val": "`That's not a planet`"},
              {"@set": "`Hint1`", "val": "`It has a big red spot`"},
              {"@set": "`Hint2`", "val": "`It's name begins with the letter J`"},
              {"@set": "`Answer`", "val": "`The biggest planet is Jupiter`"},
              {"@set": "`Hint-Announcement`", "val": "`Here's a hint`"}
            ], "if": ["?", "`Init`"]},
            {"@fork": [
              {"@do": [
                {"@act": "Question"},
                {"@fork": [
                  {"if": ["act", "CA"], "@do": [
                    {"@act": "CA-Response"},
                    {"@set": "`Is-Answer-Given`", "val": true}
                  ]},
                  {"if": ["act", "WA1"], "@do": [
                    {"@act": "WA1-Response"},
                    {"@set": "`Wrong-Counter`", "val":  ["+", 1, "Wrong-Counter"]}
                  ]},
                  {"if": ["act", "WA2"], "@do": [
                    {"@act": "WA2-Response"},
                    {"@set": "`Wrong-Counter`", "val":  ["+", 1, "Wrong-Counter"]}
                  ]},
                  {"@do": [
                    {"@set": "`Wrong-Counter`", "val":  ["+", 1, "Wrong-Counter"]}
                  ]}
                ], "await": ["act"]}
              ], "if": ["&&", ["<=", "Wrong-Counter", 3], ["!", "Is-Answer-Given"]]},
              {"@do": [
                {"@act": "Hint-Announcement"},
                {"@act": "Hint1"},
                {"@set": "`Is-Hint1-Given`", "val": true}
              ], "if": ["&&", ["!", "Is-Hint1-Given"], ["==", "Wrong-Counter", 1]]},
              {"@do": [
                {"@act": "Hint-Announcement"},
                {"@act": "Hint2"},
                {"@set": "`Is-Hint2-Given`", "val": true}
              ], "if": ["&&", ["!", "Is-Hint2-Given"], ["==", "Wrong-Counter", 2]]},
              {"@do": [
                {"@act": "Answer"},
                {"@set": "`Is-Answer-Given`", "val": true}
              ], "if": ["&&", ["!", "Is-Answer-Given"], ["==", "Wrong-Counter", 3]]}
            ], "scheme": {"depth": 3}}
          ]
        }
    </pre>
</section>


<section>
    <h2>Related Technologies</h2>
    <i>This section is informative.</i>
    <section>
        <h2>Artificial Intelligence Modelling Language (AIML)</h2>
        <p>
            AIML tightly couples dialogue logic with natural language processing (NLP).
            DMPL, on the other hand, is a general representation for dialogue flow and control without text pattern matching rules.
        </p>
    </section>
    <section>
        <h2>ChatScript</h2>
    </section>
    <section>
        <h2>RiveScript</h2>
    </section>
    <section>
        <h2>Planning Domain Definition Language (PDDL)</h2>
        <p>
            PDDL decouples the action-space (domain description) from the fluent space (problem description), just like
            DMPL. However, PDDL v3.1 (the latest version as of April 2019) incurs the following limitations:
        </p>

        <ul>
            <li>The definition of a goal in PDDL is restricted to first-order predicate logic. DMPL instead
                defines fluents by pair-wise preferences.
            </li>
            <li>
                PDDL addresses conformant planning, whereas DMPL addresses contingent planning
                <a href="https://bit.ly/2Tjj7cO">(Reference).</a>
            </li>
            <li>
                PDDL does not naturally support hierarchical planning.
            </li>
        </ul>
    </section>
</section>

<section>
    <h2>References</h2>
    <i>This section is informative.</i>
    <p>
        The primitive data types used and defined within this spec were influenced by <a href="https://bit.ly/2H35fx3">
        ISO/IEC 11404.</a> The conforming DMPL JSON syntax was influenced by <a href="http://json.org/">json.org</a> and
        <a href="https://jsonapi.org/">jsonapi.org</a>. The JSON Syntax defined within this document was developed
        using <a href="https://bit.ly/2IWdz3b">EBNF</a>. The railroad diagrams were genereated using
        <a href="https://bit.ly/2Tk2EVX">raildroad diagram generator.</a>
    </p>
</section>


<section>
    <h2>Appendix</h2>
    <p>
        EBNF Grammar.
        The extended Backus-Naur form (EBNF) grammar of the Language Syntax is fully defined below.
    </p>

    <pre class="abnf">
        /* Literal */
            literal ::= string | number | boolean | 'null'

        /* Boolean */
            boolean ::= 'true' | 'false'

        /* String */
            name ::= [http://www.w3.org/TR/xml-names/#NT-NCName]
            quote ::= '&quot;'
            tick ::= '`'
            quote_start ::= quote tick
            quote_close ::= tick quote
            string ::= quote_start name quote_close

        /* Number */
            digit ::= [0-9]
            number ::= ('-')? ((digit+ '.') | ('.' digit+) | digit+ | (digit+ '.' digit+))

        /* Variable */
            variable ::= qt name qt

        /* Dictionary */
            pairs ::= (string | variable) pair_delim expression (list_delim pairs)?
            dictionary ::= block_start pairs block_end

        /* Expression */
            expression ::= literal
            | variable
            | dictionary
            | '['
            (literal | variable)
            (',' expression)*
            ']'

        /* Statement */
            statement ::= block_start (condition list_delim)? (await list_delim)? (once list_delim)? (effect | do | fork) block_end
            condition ::= '"if"' pair_delim expression
            await ::= '"await"' ':' expression
            once ::= '"once"' ':' boolean

        /* Terminal */
            effect ::= act | set | def | run | use | pop
            act ::= '"@act"' ':' expression
            set ::= '"@set"' ':' expression ',' '"val"' ':' expression
            def ::= '"@def"' ':' expression ',' '"val"' ':' statement
            run ::= '"@run"' ':' expression (',' '"args"' ':' expression)?
            use ::= '"@use"' ':' expression (',' '"import"' ':' expression)?
            pop ::= '"@pop"' ':' expression

        /* AND */
            do ::= '"@do"' ':' '[' (statement (',' statement)*)? ']'

        /* OR */
            fork ::= '"@fork"' ':' '[' ( statement (',' statement)* )? ']' (',' scheme)?
            scheme ::= '"scheme"' ':' expression

        <?TOKENS?>
        /*TOKENS*/
            block_start ::= '{'
            block_end ::= '}'
            pair_delim ::= ':'
            list_delim ::= ','
    </pre>
</section>


</body>
</html>
